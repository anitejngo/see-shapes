import { expect } from '@jest/globals';
import { parseCoordinates } from './calculations';

describe('converting array of coordinates to objects', () => {
  test('converting simple array of x and y values', () => {
    const input = [[1, 2]];
    const result = [{ x: 1, y: 2 }];

    expect(parseCoordinates(input)).toEqual(result);
  });

  test('converting array with two coordinate points', () => {
    const input = [
      [1, 2],
      [3, 4],
    ];
    const result = [
      { x: 1, y: 2 },
      { x: 3, y: 4 },
    ];

    expect(parseCoordinates(input)).toEqual(result);
  });

  test('converting array with three coordinate points', () => {
    const input = [
      [1, 2],
      [3, 4],
      [5, 6],
    ];
    const result = [
      { x: 1, y: 2 },
      { x: 3, y: 4 },
      { x: 5, y: 6 },
    ];

    expect(parseCoordinates(input)).toEqual(result);
  });

  test('converting array with nested arrays', () => {
    const input = [
      [1, 2],
      [3, 4],
      [
        [5, 6],
        [7, 8],
      ],
    ];
    const result = [
      { x: 1, y: 2 },
      { x: 3, y: 4 },
      { x: 5, y: 6 },
      { x: 7, y: 8 },
    ];

    expect(parseCoordinates(input)).toEqual(result);
  });

  test('converting array with deeply nested arrays', () => {
    const input = [
      [1, 2],
      [3, 4],
      [
        [5, 6],
        [7, 8],
        [
          [9, 10],
          [11, 12],
        ],
      ],
    ];
    const result = [
      { x: 1, y: 2 },
      { x: 3, y: 4 },
      { x: 5, y: 6 },
      { x: 7, y: 8 },
      { x: 9, y: 10 },
      { x: 11, y: 12 },
    ];

    expect(parseCoordinates(input)).toEqual(result);
  });

  test('converting real project array with 8 polygons with 4 points ', () => {
    const input = [
      [
        [-16.556, -16.766],
        [-14.034, -16.766],
        [-14.034, -14.952999999999998],
        [-16.556, -14.952999999999998],
      ],
      [
        [-16.556, -15.032999999999998],
        [-14.034, -15.032999999999998],
        [-14.034, -13.219999999999997],
        [-16.556, -13.219999999999997],
      ],
      [
        [-16.556, -13.299999999999997],
        [-14.034, -13.299999999999997],
        [-14.034, -11.486999999999997],
        [-16.556, -11.486999999999997],
      ],
      [
        [-16.556, -11.566999999999997],
        [-14.034, -11.566999999999997],
        [-14.034, -9.753999999999996],
        [-16.556, -9.753999999999996],
      ],
      [
        [-16.556, -9.833999999999996],
        [-14.034, -9.833999999999996],
        [-14.034, -8.020999999999995],
        [-16.556, -8.020999999999995],
      ],
      [
        [-16.556, -8.100999999999996],
        [-14.034, -8.100999999999996],
        [-14.034, -6.287999999999996],
        [-16.556, -6.287999999999996],
      ],
      [
        [-14.22, -16.766],
        [-11.698, -16.766],
        [-11.698, -14.952999999999998],
        [-14.22, -14.952999999999998],
      ],
      [
        [-14.22, -15.032999999999998],
        [-11.698, -15.032999999999998],
        [-11.698, -13.219999999999997],
        [-14.22, -13.219],
      ],
    ];

    const result = [
      { x: -16.556, y: -16.766 },
      { x: -14.034, y: -16.766 },
      { x: -14.034, y: -14.952999999999998 },
      { x: -16.556, y: -14.952999999999998 },
      { x: -16.556, y: -15.032999999999998 },
      { x: -14.034, y: -15.032999999999998 },
      { x: -14.034, y: -13.219999999999997 },
      { x: -16.556, y: -13.219999999999997 },
      { x: -16.556, y: -13.299999999999997 },
      { x: -14.034, y: -13.299999999999997 },
      { x: -14.034, y: -11.486999999999997 },
      { x: -16.556, y: -11.486999999999997 },
      { x: -16.556, y: -11.566999999999997 },
      { x: -14.034, y: -11.566999999999997 },
      { x: -14.034, y: -9.753999999999996 },
      { x: -16.556, y: -9.753999999999996 },
      { x: -16.556, y: -9.833999999999996 },
      { x: -14.034, y: -9.833999999999996 },
      { x: -14.034, y: -8.020999999999995 },
      { x: -16.556, y: -8.020999999999995 },
      { x: -16.556, y: -8.100999999999996 },
      { x: -14.034, y: -8.100999999999996 },
      { x: -14.034, y: -6.287999999999996 },
      { x: -16.556, y: -6.287999999999996 },
      { x: -14.22, y: -16.766 },
      { x: -11.698, y: -16.766 },
      { x: -11.698, y: -14.952999999999998 },
      { x: -14.22, y: -14.952999999999998 },
      { x: -14.22, y: -15.032999999999998 },
      { x: -11.698, y: -15.032999999999998 },
      { x: -11.698, y: -13.219999999999997 },
      { x: -14.22, y: -13.219 },
    ];

    expect(parseCoordinates(input)).toEqual(result);
  });

  test('converting already converted array', () => {
    const input = [
      { x: 1, y: 2 },
      { x: 3, y: 4 },
    ];

    expect(parseCoordinates(input)).toEqual(input);
  });
});
